import { extract_lines } from '@beenotung/tslib/string'
import { translate } from './client'
import debug from 'debug'

let log = debug('test')
log.enabled = true

let text = `
è­·çœ¼ç´ 
éˆèŠå­¢å­
è¿·ä½ æ‰“å°æ©Ÿ
é˜²æ°´èƒŒå›Š
å¾©å¤æ‰‹è¢‹
æµ·é¹½ç“œå­
æ£®æž—å‹å¥½ç’°ä¿ç´™å·¾
é«˜éˆ£ä½Žè„‚æ¤ç‰©å¥¶
æ©Ÿé›»ç½²èªè­‰è¬èƒ½æ’è˜‡æ‹–æŠŠ
4K LED 34å¯¸é›»è¦–
éº¥æ¨‚é›ž
é›»æ± çˆ
Level 3 é†«ç”¨å£ç½©
æ‰“å°æ©Ÿä»£ç”¨å¢¨ç›’
æ¸¯å¼å¥¶èŒ¶ç´™åŒ…é£²å“
é›»è…¦å­¸é«˜ç´šæ–‡æ†‘èª²ç¨‹
æœƒå“¡ç©åˆ†ç¨‹å¼æŽ¨å»£
é¹½ç„—é–‹å¿ƒæžœ
`

async function main() {
  let names = extract_lines(text)
  let label = 'translate ' + names.length + ' items'
  console.time(label)
  await Promise.all(
    names.map(async src => {
      let en = await translate({
        text: src,
        target_lang: 'en',
        source_lang: 'zh',
      })
      log({ src, en })
    }),
  )
  console.timeEnd(label)

  {
    let src = `ðŸ¤”ESGé—œä¸­å°ä¼åŒåˆå‰µå¾®ä¼äº‹å—Žï¼Ÿ
.
å…ˆè¬›ä¸€å€‹æ•…äº‹å…ˆï¼Œè©±èªªæŸå¤§é¾é ­æ‰‹æ©Ÿè£½é€ å•†ï¼Œå› è¦æŽ¨é«˜è‚¡åƒ¹ï¼Œæ‰€ä»¥ä¸å¾—ä¸æžå¥½ä½¢å˜…ESGè©•ç´šï¼ˆESGè©•ç´šæœƒç›´æŽ¥å½±éŸ¿è‚¡åƒ¹çš„ï¼‰ï¼Œè€Œå…¶ä¸­ä¸€å€‹å¥½å½±éŸ¿ESGè©•ç´šå˜…å› ç´ å°±ä¿‚ä¾›æ‡‰éˆï¼ˆSupply Chainï¼‰å˜…ä¸Šæ¸¸ä¾›æ‡‰å•†æ‰€æä¾›å˜…éƒ¨ä»¶æœ‰å†‡è·Ÿè¶³ESGå˜…çŽ©æ³•ï¼Œä»¥è©²æ‰‹æ©Ÿè£½é€ å•†ç‚ºä¾‹ï¼Œä½¢åœ°å˜…èžºçµ²å°±éœ€è¦åŒä¸Šæ¸¸å˜…ä¾›æ‡‰å•†æ”žè²¨ã€‚ä½†ä¿‚å¦‚æžœæžœé–“ä¸Šæ¸¸å» å•†åƒ±ç”¨ç«¥å·¥æˆ–è€…ç‹‚churå“¡å·¥é–‹å·¥å””æ¯”å“¡å·¥ä¼‘æ¯ï¼Œåˆæˆ–è€…ç²’èžºçµ²ç”¨å’—å•²å””ç’°ä¿å˜…ç‰©æ–™åšŸè£½ä½œï¼Œåˆæˆ–è€…é–“ä¸Šæ¸¸å» å˜…è‘£äº‹å±€ä¸­å˜…ç”·å¥³æ¯”ä¾‹ä¿‚æ¸…ä¸€è‰²ç”·æ€§ï¼Œå’éƒ½ä¿‚é•åå’—ESGï¼Œå¦‚æžœè©²æ‰‹æ©Ÿè£½é€ å•†ç”¨å“©é–“ä¸Šæ¸¸å» æ‰€ç”Ÿç”¢å˜…éƒ¨ä»¶ï¼Œä½¢å˜…ESGè©•ç´šå°±æœƒè¢«æ‹‰ä½Žï¼Œè‚¡åƒ¹äº¦æœƒéš¨ä¹‹è€Œä¸‹æ»‘ï¼
.
å’ï¼Œå³ä¿‚åŒä¸­å°ä¼åŒåˆå‰µå¾®ä¼æœ‰å’©é—œä¿‚ï¼Ÿ
.
å’ç•¶ç„¶æœ‰é—œå§ï¼Œè©¦è«—å“ï¼Œå¦‚æžœä½ å˜…å…¬å¸å””ç¬¦åˆESGæ¨™æº–ï¼Œå’å…¶ä»–è¦åŒä½ æ”žè²¨å˜…å» å•†ä»²æœƒå””æœƒæ€ä½ ï¼Ÿä½ è©±å¦‚æžœä½ è³£å¾—å¹³å•²ï¼Œå’å‡å¦‚å¦ä¸€é–“å» å•†åŒä½ åƒ¹éŒ¢å·®å””å¤šä½†ESGåšå¾—å¥½éŽä½ ï¼Œå’ä¸‹æ¸¸å» å•†æœƒæ€ä½ å®šä½¢ï¼Ÿ`
    console.time('translate long text')
    console.log('='.repeat(8) + ' zh ' + '='.repeat(8))
    console.log(src)
    console.log('='.repeat(8) + ' en ' + '='.repeat(8))
    let en = await translate({
      text: src,
      source_lang: 'zh',
      target_lang: 'en',
    })
    console.log(en)
    console.log('='.repeat(8 + 4 + 8))
    console.timeEnd('translate long text')
  }
}
main().catch(e => console.error(e))
